integrate nagios to ELK using filebeat

ğŸ”§ Objective
Send Nagios logs and alerts to Elasticsearch for visualization in Kibana, using Filebeat or Logstash.

âœ… Architecture
plaintext
CopyEdit
[Nagios] 
   â†“ (log files: nagios.log, perfdata.log)
[Filebeat or Logstash]
   â†“
[Elasticsearch]
   â†“
[Kibana]


ğŸ§± STEP 1: Identify Nagios Log Files
Default log location:

 swift
CopyEdit
/usr/local/nagios/var/nagios.log
/usr/local/nagios/var/archive/  (for old logs)
/var/log/nagios3/nagios.log     (Debian/Ubuntu)


Performance data (if enabled):

 swift
CopyEdit
/usr/local/nagios/var/perfdata.log



ğŸ§° STEP 2: Install Filebeat (Recommended)
Install Filebeat on the Nagios server.
ğŸ“¥ Install Filebeat on Debian/Ubuntu:
bash
CopyEdit
curl -L -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.17.9-amd64.deb
sudo dpkg -i filebeat-7.17.9-amd64.deb


âš™ï¸ STEP 3: Configure Filebeat to Read Nagios Logs
Edit the Filebeat config:
bash
CopyEdit
sudo nano /etc/filebeat/filebeat.yml

â• Add Custom Input:
yaml
CopyEdit
filebeat.inputs:
- type: log
  enabled: true
  paths:
    - /usr/local/nagios/var/nagios.log
    - /usr/local/nagios/var/archive/*.log
  fields:
    log_type: nagios


ğŸ§ª STEP 4: Test Filebeat & Enable Modules (optional)
bash
CopyEdit
sudo filebeat modules enable system
sudo filebeat test config


ğŸš€ STEP 5: Output to Logstash or Elasticsearch
Choose one:
âœ… Option A: Send Directly to Elasticsearch
In filebeat.yml, set:
yaml
CopyEdit
output.elasticsearch:
  hosts: ["http://<ELASTICSEARCH_IP>:9200"]

âœ… Option B: Send to Logstash (if you use custom parsing)
yaml
CopyEdit
output.logstash:
  hosts: ["<LOGSTASH_IP>:5044"]


ğŸ“¡ STEP 6: Start Filebeat
bash
CopyEdit
sudo systemctl enable filebeat
sudo systemctl start filebeat


ğŸ“Š STEP 7: View Logs in Kibana
Open Kibana â†’ Discover


Set index pattern: filebeat-*


Filter by:

 arduino
CopyEdit
fields.log_type : "nagios"



ğŸ› ï¸ OPTIONAL: Parsing with Logstash
If you're using Logstash between Filebeat and Elasticsearch:
Sample Logstash Config:
bash
CopyEdit
sudo nano /etc/logstash/conf.d/nagios.conf

ruby
CopyEdit
input {
  beats {
    port => 5044
  }
}

filter {
  if [fields][log_type] == "nagios" {
    grok {
      match => { "message" => "%{TIMESTAMP_ISO8601:timestamp} %{WORD:host_state} ..." }
    }
  }
}

output {
  elasticsearch {
    hosts => ["http://localhost:9200"]
    index => "nagios-logs-%{+YYYY.MM.dd}"
  }
}
